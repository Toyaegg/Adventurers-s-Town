[gd_resource type="BehaviorTree" load_steps=72 format=3 uid="uid://f3yn7iro8hc7"]

[ext_resource type="Script" path="res://ai/tasks/get_transport_position.gd" id="1_04iu7"]
[ext_resource type="Script" path="res://ai/tasks/find_building.gd" id="1_o36ml"]
[ext_resource type="Script" path="res://ai/tasks/move_to_position.gd" id="2_5uimt"]
[ext_resource type="Script" path="res://ai/tasks/use_transport.gd" id="3_e3vvl"]
[ext_resource type="Script" path="res://ai/tasks/enter_building.gd" id="3_jww56"]
[ext_resource type="Script" path="res://ai/tasks/use_building.gd" id="4_t111f"]
[ext_resource type="Script" path="res://ai/tasks/get_building_position.gd" id="5_p8act"]
[ext_resource type="Script" path="res://ai/tasks/exit_building.gd" id="5_qtkdm"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_1xo44"]

[sub_resource type="BBVariant" id="BBVariant_svfsk"]
type = 3
saved_value = 0.2
resource_name = "0.19999999999709"

[sub_resource type="BTCheckAgentProperty" id="BTCheckAgentProperty_21qes"]
property = &"mp_amount"
check_type = 4
value = SubResource("BBVariant_svfsk")

[sub_resource type="BTWait" id="BTWait_hbq2f"]

[sub_resource type="BTFail" id="BTFail_aa2ae"]

[sub_resource type="BTSequence" id="BTSequence_tu41v"]
custom_name = "副本前准备"
children = [SubResource("BTCheckAgentProperty_21qes"), SubResource("BTWait_hbq2f"), SubResource("BTFail_aa2ae")]

[sub_resource type="BTAction" id="BTAction_vhv1w"]
custom_name = "获取传送位置"
script = ExtResource("1_04iu7")

[sub_resource type="BTAction" id="BTAction_r3yw2"]
custom_name = "移动到传送位置"
script = ExtResource("2_5uimt")
position_var = &"position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_xrspp"]
custom_name = "使用传送"
script = ExtResource("3_e3vvl")

[sub_resource type="BTSequence" id="BTSequence_ctqig"]
custom_name = "前往副本"
children = [SubResource("BTAction_vhv1w"), SubResource("BTAction_r3yw2"), SubResource("BTAction_xrspp")]

[sub_resource type="BTWait" id="BTWait_d5ukf"]

[sub_resource type="BTSequence" id="BTSequence_c8npt"]
custom_name = "挑战副本"
children = [SubResource("BTWait_d5ukf")]

[sub_resource type="BTWait" id="BTWait_4p76y"]

[sub_resource type="BTAction" id="BTAction_a60mh"]
custom_name = "使用传送"
script = ExtResource("3_e3vvl")

[sub_resource type="BTSequence" id="BTSequence_c6l1x"]
custom_name = "副本完成"
children = [SubResource("BTWait_4p76y"), SubResource("BTAction_a60mh")]

[sub_resource type="BTCooldown" id="BTCooldown_g2gu7"]
children = [SubResource("BTSequence_tu41v"), SubResource("BTSequence_ctqig"), SubResource("BTSequence_c8npt"), SubResource("BTSequence_c6l1x")]

[sub_resource type="BTAction" id="BTAction_omk2n"]
custom_name = "寻找商行"
script = ExtResource("1_o36ml")
building_id = &"fg"
building_var = &"building"
feature = 3

[sub_resource type="BTAction" id="BTAction_1lsrp"]
custom_name = "获取商行位置"
script = ExtResource("5_p8act")
position_var = &"position"
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_2mp53"]
custom_name = "移动到商行"
script = ExtResource("2_5uimt")
position_var = &"position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_a0qdu"]
custom_name = "进入商行"
script = ExtResource("3_jww56")
building_var = &"building"

[sub_resource type="BTWait" id="BTWait_vysey"]
duration = 3.0

[sub_resource type="BTAction" id="BTAction_5mm3r"]
custom_name = "卖出杂物"
script = ExtResource("4_t111f")
building_var = &"building"
feature = 3

[sub_resource type="BTAction" id="BTAction_dqnut"]
custom_name = "退出商行"
script = ExtResource("5_qtkdm")
building_var = &"building"

[sub_resource type="BTWait" id="BTWait_jxbyy"]

[sub_resource type="BTSequence" id="BTSequence_ls62h"]
custom_name = "战利品处理"
children = [SubResource("BTAction_omk2n"), SubResource("BTAction_1lsrp"), SubResource("BTAction_2mp53"), SubResource("BTAction_a0qdu"), SubResource("BTWait_vysey"), SubResource("BTAction_5mm3r"), SubResource("BTAction_dqnut"), SubResource("BTWait_jxbyy")]

[sub_resource type="BBVariant" id="BBVariant_6wtsr"]
type = 3
saved_value = 0.2
resource_name = "0.2"

[sub_resource type="BTCheckAgentProperty" id="BTCheckAgentProperty_xtcfi"]
property = &"hp_amount"
check_type = 1
value = SubResource("BBVariant_6wtsr")

[sub_resource type="BTAction" id="BTAction_u66ck"]
custom_name = "寻找教堂"
script = ExtResource("1_o36ml")
building_id = &"c"
building_var = &"building"
feature = 4

[sub_resource type="BTAction" id="BTAction_6wbs3"]
custom_name = "寻找教堂位置"
script = ExtResource("5_p8act")
position_var = &"position"
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_pyuxe"]
custom_name = "移动到教堂"
script = ExtResource("2_5uimt")
position_var = &"position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_lbds2"]
custom_name = "进入教堂"
script = ExtResource("3_jww56")
building_var = &"building"

[sub_resource type="BTWait" id="BTWait_bg51w"]
duration = 3.0

[sub_resource type="BTAction" id="BTAction_x6c5k"]
custom_name = "使用教堂治疗"
script = ExtResource("4_t111f")
building_var = &"building"
feature = 4

[sub_resource type="BTAction" id="BTAction_w6yp8"]
custom_name = "退出教堂"
script = ExtResource("5_qtkdm")
building_var = &"building"

[sub_resource type="BTWait" id="BTWait_jgng7"]

[sub_resource type="BTSequence" id="BTSequence_m0kir"]
custom_name = "进行治疗"
children = [SubResource("BTCheckAgentProperty_xtcfi"), SubResource("BTAction_u66ck"), SubResource("BTAction_6wbs3"), SubResource("BTAction_pyuxe"), SubResource("BTAction_lbds2"), SubResource("BTWait_bg51w"), SubResource("BTAction_x6c5k"), SubResource("BTAction_w6yp8"), SubResource("BTWait_jgng7")]

[sub_resource type="BBVariant" id="BBVariant_sykiv"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckAgentProperty" id="BTCheckAgentProperty_pdrsj"]
property = &"has_curse"
value = SubResource("BBVariant_sykiv")

[sub_resource type="BTAction" id="BTAction_0oxdx"]
custom_name = "寻找教堂"
script = ExtResource("1_o36ml")
building_id = &"c"
building_var = &"building"
feature = 5

[sub_resource type="BTAction" id="BTAction_ik662"]
custom_name = "寻找教堂位置"
script = ExtResource("5_p8act")
position_var = &"position"
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_q2yc6"]
custom_name = "移动到教堂"
script = ExtResource("2_5uimt")
position_var = &"position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_j3jn1"]
custom_name = "进入教堂"
script = ExtResource("3_jww56")
building_var = &"building"

[sub_resource type="BTWait" id="BTWait_eemrs"]
duration = 3.0

[sub_resource type="BTAction" id="BTAction_2upkc"]
custom_name = "使用教堂驱散"
script = ExtResource("4_t111f")
building_var = &"building"
feature = 5

[sub_resource type="BTAction" id="BTAction_gx8oh"]
custom_name = "退出教堂"
script = ExtResource("5_qtkdm")
building_var = &"building"

[sub_resource type="BTWait" id="BTWait_ushmx"]

[sub_resource type="BTSequence" id="BTSequence_vlor8"]
custom_name = "解除诅咒"
children = [SubResource("BTCheckAgentProperty_pdrsj"), SubResource("BTAction_0oxdx"), SubResource("BTAction_ik662"), SubResource("BTAction_q2yc6"), SubResource("BTAction_j3jn1"), SubResource("BTWait_eemrs"), SubResource("BTAction_2upkc"), SubResource("BTAction_gx8oh"), SubResource("BTWait_ushmx")]

[sub_resource type="BTAction" id="BTAction_jmd5m"]
custom_name = "寻找酒馆旅店"
script = ExtResource("1_o36ml")
building_id = &"i"
building_var = &"building"
feature = 7

[sub_resource type="BTAction" id="BTAction_g8ueu"]
custom_name = "寻找旅店位置"
script = ExtResource("5_p8act")
position_var = &"position"
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_3ruk0"]
custom_name = "移动到旅店"
script = ExtResource("2_5uimt")
position_var = &"position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_tnmof"]
custom_name = "进入旅店"
script = ExtResource("3_jww56")
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_ikucy"]
custom_name = "使用旅店"
script = ExtResource("4_t111f")
building_var = &"building"
feature = 7

[sub_resource type="BTAction" id="BTAction_5neqg"]
custom_name = "退出旅店"
script = ExtResource("5_qtkdm")
building_var = &"building"

[sub_resource type="BTSequence" id="BTSequence_5jl0i"]
custom_name = "没有房子"
children = [SubResource("BTAction_jmd5m"), SubResource("BTAction_g8ueu"), SubResource("BTAction_3ruk0"), SubResource("BTAction_tnmof"), SubResource("BTAction_ikucy"), SubResource("BTAction_5neqg")]

[sub_resource type="BTAction" id="BTAction_savbr"]
custom_name = "寻找自己的住宅"
script = ExtResource("1_o36ml")
building_id = &"h"
building_var = &"building"
feature = 0

[sub_resource type="BTAction" id="BTAction_64ssf"]
custom_name = "寻找住宅位置"
script = ExtResource("5_p8act")
position_var = &"position"
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_jiyvv"]
custom_name = "移动到住宅"
script = ExtResource("2_5uimt")
position_var = &"position"
tolerance = 10.0

[sub_resource type="BTAction" id="BTAction_a8dwh"]
custom_name = "进入住宅"
script = ExtResource("3_jww56")
building_var = &"building"

[sub_resource type="BTAction" id="BTAction_ybsnm"]
custom_name = "使用住宅"
script = ExtResource("4_t111f")
building_var = &"building"
feature = 7

[sub_resource type="BTAction" id="BTAction_1jm77"]
custom_name = "退出住宅"
script = ExtResource("5_qtkdm")
building_var = &"building"

[sub_resource type="BTSequence" id="BTSequence_5kmey"]
custom_name = "有房子"
children = [SubResource("BTAction_savbr"), SubResource("BTAction_64ssf"), SubResource("BTAction_jiyvv"), SubResource("BTAction_a8dwh"), SubResource("BTAction_ybsnm"), SubResource("BTAction_1jm77")]

[sub_resource type="BTSequence" id="BTSequence_ta14u"]
custom_name = "休息流程"
children = [SubResource("BTSequence_5jl0i"), SubResource("BTSequence_5kmey")]

[sub_resource type="BTSelector" id="BTSelector_y7vvi"]
custom_name = "冒险者行为"
children = [SubResource("BTCooldown_g2gu7"), SubResource("BTSequence_ls62h"), SubResource("BTSequence_m0kir"), SubResource("BTSequence_vlor8"), SubResource("BTSequence_ta14u")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_1xo44")
root_task = SubResource("BTSelector_y7vvi")
